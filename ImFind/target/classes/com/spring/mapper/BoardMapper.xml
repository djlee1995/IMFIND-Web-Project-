<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.spring.mapper.EJ.BoardMapper">

   <insert id = "itemInsert" >
   insert into LostPost 
   (Lost_Title, 
   Lost_Content, 
   Lost_Up_File,
   Lost_Item, 
   Lost_Re_Date, 
   Lost_Date, 
   Lost_Loc, 
   Lost_Pay,
   Id)values 
   (#{Lost_Title}, 
   #{Lost_Content}, 
   #{Lost_Up_File},
   #{Lost_Item}, 
   sysdate, 
   #{Lost_Date}, 
   #{Lost_Loc}, 
   #{Lost_Pay},
   #{Id})

   </insert>
    
    <select id="getPayMember" resultType="com.spring.imfind.el.EJ.MemberVO">
    SELECT id, Name, Contact, Email from Member 
    WHERE id=#{id}
    </select>
    
    <insert id = "insertPay" >
    insert into Pay 
    (PayCode, 
    Pay_Amount, 
    Pay_Way, 
    Pay_State, 
    Pay_Date,Id)values 
    (#{PayCode}, 
    #{Pay_Amount}, 
    #{Pay_Way}, 
    #{Pay_State},
    #{Pay_Date},
    #{Id})
    </insert>
   
     <insert id = "petInsert" >
    insert into PatPost 
    (Pat_Title, 
    Pat_Content, 
    Pat_Name, 
    Pat_Re_Date, 
    Pat_LostDate, 
    Pat_Loc, 
    Pat_Pay,Id)values 
    (#{Pat_Title}, 
    #{Pat_Content}, 
    #{Pat_Name}, 
    sysdate, 
    #{Pat_LostDate}, 
    #{Pat_Loc}, 
    #{Pat_Pay},
    #{Id})
    </insert>
    <!-- 여기서 동적쿼리문으로 조건문 처리  -->
    <insert id="commentInsert" parameterType="LostComVO">
        <selectKey keyProperty="Com_Num" order="BEFORE" resultType="int">
            select nvl(max(Com_Num), 0)+1 from Re_Comment
        </selectKey>  
          insert into Re_Comment (Com_Num, Lost_PostNum, Com_Content, Id, Com_Date, Secret_Com)
          values(#{Com_Num},#{Lost_PostNum},#{Com_Content},#{Id},sysdate,#{Secret_Com})
     </insert>
     
     <select id ="commentList" parameterType="int" resultType="LostComVO">
      select * from Re_Comment where Lost_PostNum = #{Lost_PostNum} order by Com_Num desc
     </select>
    
   
     <update id ="commentUpdate" parameterType="LostComVO">
      update Re_Comment set Com_Content = #{Com_Content} WHERE Com_Num = #{Com_Num}
     </update>
     
     <delete id="commentDelete" parameterType="int">
      delete from Re_Comment WHERE Com_Num = #{Com_Num}
     </delete>
     
<!-- 동준 대댓글 -->
     <insert id="replyInsert" parameterType="replyVO">
        <selectKey keyProperty="re_num" order="BEFORE" resultType="int">
            select nvl(max(re_Num), 0)+1 from reply
        </selectKey>  
          insert into reply (re_num,re_content,re_date,id,com_num)
          values(#{re_num},#{re_content},sysdate,#{id},#{com_num})
     </insert>
     
    <select id ="replyList"  resultType="replyVO">
      select * from reply order by re_num    
   </select>
   <delete id ="replyDelete">
      delete from reply where re_num = #{re_num}    
   </delete>
    <!-- 동준 대댓글  끝-->
</mapper> 